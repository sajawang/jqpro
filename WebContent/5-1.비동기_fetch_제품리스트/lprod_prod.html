<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" href="http://localhost/webpro/css/public.css">
<script src="../js/jquery-3.7.1.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script type="text/javascript">
  $( () =>{
	  $('#lprod').on('change',function(){
		lgu=$("option : selected",this).val();
		//alert(lgu);
		
		//자바 스크립트 객체
		lguvalue = {lprod_gu : lgu};
		
		
		fetch('prodController.jsp',{
			method : 'post',
			headers : "", 
			body : lguvalue 
		})
		.then( res =>{
			console.log(res);
			if(res.ok) res.JSON();
			else {
				new Error("오류 :" +res.statusText)
			}
		})
		.then( data =>{
			console.log(data);
		})
		.catch( err =>{
			alert("오류"+err.statusText)
		})
	  })
  })
  
  //처음 확인버튼 클릭하면 lprod의 gu와 nm정보를 option으로 출력
  const proc1= () =>{
	
	  fetch('lprodController.jsp')
	  .then( (res) => {
		  console.log(res)
		  return res.json();
	  })
	  .then(data=>{
		  code="";
		  for(item of data){
			  code += `<option value="item.lprod_gu"> ${item.lprod_nm}</option>`
		  }
		  $('#lprod').html(code);
	  })
	  .catch( err=>{
		  alert(err)
	  })
  }
  
  </script>
</head>
<body>

<div class="box">
  <h3></h3>
   <input type="button" value="확인" onclick="proc1()">
  <br>
  
  <div class="container mt-3">
  <h2>제품리스트</h2>
  <form>
    <label for="lprod" class="form-label">Select list (lprod):</label>
    <select class="form-select" id="lprod" name="sellist1">
    </select>
    <br>
    
    <label for="prod" class="form-label">select list (prod):</label>
    <select class="form-select" id="prod" name="sellist2">
    </select>
  </form>
</div>
<div id="result1"></div>
</div>
</body>
</html>